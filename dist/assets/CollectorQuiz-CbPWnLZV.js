import{u as U,d as H,r as i,s as C,z as x,j as e,L as A,H as P}from"./index-Tyz_JBt9.js";import{X as T}from"./x-jv565ngo.js";import{H as Y}from"./heart-BZ8u-Y3T.js";import{A as M}from"./arrow-right-DYyn1uxC.js";import{C as G}from"./circle-check-big-D0cnAB6B.js";import"./createLucideIcon-DhCu6Z8O.js";const re=()=>{const F=U(),{user:w}=H(),[o,u]=i.useState(0),[l,j]=i.useState({}),[p,D]=i.useState([]),[h,$]=i.useState(0),[E,_]=i.useState(!0),[q,v]=i.useState(!1),[N,f]=i.useState(null),[d,k]=i.useState(0),[g,b]=i.useState(!1),[I,R]=i.useState(0),W=i.useRef(null),c=[{id:"welcome",type:"artwork",question:"Welcome! Let's discover your art taste. Swipe right on artworks you love, left on ones you don't.",required:!1},{id:"artwork_preferences",type:"artwork",question:"Which artworks appeal to you?",required:!0},{id:"style_preferences",type:"style",question:"What art styles do you prefer?",options:["Abstract","Realism","Impressionism","Contemporary","Minimalist","Pop Art","Surrealism","Expressionism","Cubism","Photorealism"],required:!0},{id:"color_preferences",type:"color",question:"Which color palettes speak to you?",options:["Warm & Vibrant","Cool & Calm","Monochrome","Pastel","Bold & Contrasting","Earth Tones","Neon & Bright","Muted & Subtle"],required:!0},{id:"mood_preferences",type:"mood",question:"What mood do you want your art to evoke?",options:["Calm & Peaceful","Energetic & Dynamic","Mysterious & Intriguing","Joyful & Uplifting","Thoughtful & Contemplative","Bold & Confident","Romantic & Dreamy","Edgy & Provocative"],required:!0},{id:"budget_range",type:"budget",question:"What's your budget range for art purchases?",options:["Under $500","$500 - $2,000","$2,000 - $10,000","$10,000 - $50,000","$50,000+","No specific budget"],required:!0},{id:"space_preferences",type:"space",question:"Where will you display your art?",options:["Living Room","Bedroom","Office","Dining Room","Hallway","Outdoor Space","Multiple Rooms","Gallery Wall"],required:!0}];i.useEffect(()=>{L()},[]);const L=async()=>{try{_(!0);const{data:s,error:t}=await C.from("artworks").select(`
          id,
          title,
          image_url,
          primary_image_url,
          medium,
          year,
          price,
          currency,
          dimensions,
          user:profiles!artworks_user_id_fkey(
            full_name,
            display_name
          )
        `).eq("status","Available").limit(50);if(t)throw t;const n=(s||[]).map(r=>({id:r.id,title:r.title,image_url:r.primary_image_url||r.image_url||"",artist_name:r.user?.full_name||r.user?.display_name||"Unknown Artist",medium:r.medium||"Mixed Media",year:r.year||new Date().getFullYear(),price:r.price||0,currency:r.currency||"USD",dimensions:r.dimensions||{width:0,height:0,unit:"cm"},style:"Contemporary",genre:"Fine Art",color_palette:["#000000","#FFFFFF"],mood:"Neutral",technique:"Mixed Media"}));D(n)}catch(s){console.error("Error loading artworks:",s),x.error("Failed to load artworks")}finally{_(!1)}},y=s=>{if(o===1){const t=p[h];if(t){const n=l.artwork_preferences||[];s==="right"&&j(r=>({...r,artwork_preferences:[...n,t.id]})),h<p.length-1?$(r=>r+1):u(r=>r+1)}}else u(t=>t+1)},X=s=>{b(!0),R(s.clientX)},O=s=>{if(!g)return;const n=s.clientX-I;k(n),Math.abs(n)>50?f(n>0?"right":"left"):f(null)},z=()=>{g&&(b(!1),Math.abs(d)>100&&y(d>0?"right":"left"),k(0),f(null))},B=s=>{const t=c[o];j(n=>({...n,[t.id]:[...n[t.id]||[],s]}))},S=()=>{o<c.length-1?u(s=>s+1):Q()},Q=async()=>{try{v(!0);const s={preferred_styles:l.style_preferences||[],preferred_genres:["Fine Art"],preferred_mediums:["Oil","Acrylic","Mixed Media"],color_preferences:l.color_preferences||[],mood_preferences:l.mood_preferences||[],budget_range:{min:0,max:1e5},space_preferences:l.space_preferences||[],experience_level:"intermediate",collecting_focus:"personal",risk_tolerance:"moderate"};if(w){const{error:t}=await C.from("profiles").update({collector_preferences:s,quiz_completed:!0,quiz_completed_at:new Date().toISOString()}).eq("id",w.id);if(t)throw t}x.success("Quiz completed! Your preferences have been saved."),F("/u/dashboard")}catch(s){console.error("Error saving quiz results:",s),x.error("Failed to save quiz results")}finally{v(!1)}},m=c[o],a=p[h];return E?e.jsx("div",{className:"quiz-container",children:e.jsx("div",{className:"quiz-loading",children:e.jsx(A,{size:"lg",text:"Loading artworks..."})})}):e.jsxs(e.Fragment,{children:[e.jsxs(P,{children:[e.jsx("title",{children:"Art Taste Quiz | ArtFlow"}),e.jsx("meta",{name:"description",content:"Discover your unique art taste with our intelligent quiz"})]}),e.jsxs("div",{className:"quiz-container",children:[e.jsxs("div",{className:"quiz-progress",children:[e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${(o+1)/c.length*100}%`}})}),e.jsxs("span",{className:"progress-text",children:[o+1," of ",c.length]})]}),e.jsxs("div",{className:"quiz-header",children:[e.jsx("h1",{className:"quiz-title",children:m.question}),o===1&&e.jsx("p",{className:"quiz-subtitle",children:"Swipe right on artworks you love, left on ones you don't"})]}),e.jsx("div",{className:"quiz-content",children:m.type==="artwork"&&a?e.jsxs("div",{className:"artwork-card-container",children:[e.jsx("div",{ref:W,className:`artwork-card ${N?`swipe-${N}`:""}`,style:{transform:`translateX(${d}px) rotate(${d*.1}deg)`,opacity:g?.8:1},onMouseDown:X,onMouseMove:O,onMouseUp:z,onMouseLeave:z,children:e.jsxs("div",{className:"artwork-image",children:[e.jsx("img",{src:a.image_url||"https://placehold.co/400x600?text=No+Image",alt:a.title,draggable:!1}),e.jsx("div",{className:"artwork-overlay",children:e.jsxs("div",{className:"artwork-info",children:[e.jsx("h3",{className:"artwork-title",children:a.title}),e.jsx("p",{className:"artwork-artist",children:a.artist_name}),e.jsxs("p",{className:"artwork-details",children:[a.medium," â€¢ ",a.year]}),a.price>0&&e.jsx("p",{className:"artwork-price",children:new Intl.NumberFormat("en-US",{style:"currency",currency:a.currency}).format(a.price)})]})})]})}),e.jsxs("div",{className:"swipe-actions",children:[e.jsx("button",{className:"swipe-btn swipe-left",onClick:()=>y("left"),children:e.jsx(T,{size:24})}),e.jsx("button",{className:"swipe-btn swipe-right",onClick:()=>y("right"),children:e.jsx(Y,{size:24})})]})]}):e.jsx("div",{className:"quiz-options",children:m.options?.map((s,t)=>e.jsx("button",{className:`option-btn ${l[m.id]?.includes(s)?"selected":""}`,onClick:()=>B(s),children:s},t))})}),e.jsxs("div",{className:"quiz-navigation",children:[o>0&&e.jsxs("button",{className:"quiz-btn secondary",onClick:()=>u(s=>s-1),children:[e.jsx(M,{size:16,style:{transform:"rotate(180deg)"}}),"Back"]}),e.jsx("button",{className:"quiz-btn primary",onClick:S,disabled:q,children:q?e.jsx(A,{size:"sm"}):o===c.length-1?e.jsxs(e.Fragment,{children:["Complete Quiz",e.jsx(G,{size:16})]}):e.jsxs(e.Fragment,{children:["Next",e.jsx(M,{size:16})]})})]}),o>0&&e.jsx("button",{className:"quiz-skip",onClick:S,children:"Skip this step"})]})]})};export{re as default};
