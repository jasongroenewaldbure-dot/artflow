import{r as l,s as k,n,j as e,H as P,a as j}from"./index-Tyz_JBt9.js";import{I as c}from"./Icon-DdnnFTJv.js";const B=()=>{const[v,C]=l.useState([]),[d,T]=l.useState([]),[D,N]=l.useState(!0),[w,f]=l.useState(null),[o,y]=l.useState(""),[u,_]=l.useState("grid"),[g,S]=l.useState(!1),[h,F]=l.useState("newest"),[r,m]=l.useState({accessType:"all",dateRange:"all"});l.useEffect(()=>{b()},[]),l.useEffect(()=>{$()},[v,o,h,r]);const b=async()=>{try{N(!0),f(null);const{data:a,error:s}=await k.from("catalogues").select(`
          id, title, slug, description, cover_image_url, is_public, access_type, created_at, updated_at, user_id
        `).eq("is_public",!0).order("updated_at",{ascending:!1});if(s)throw console.error("Error loading catalogues:",s),s;const t=[...new Set((a||[]).map(i=>i.user_id))],{data:p}=await k.from("profiles").select("id, full_name, slug").in("id",t),z=new Map(p?.map(i=>[i.id,i])||[]),M=a?.map(i=>{const x=z.get(i.user_id);return{...i,artist:{id:x?.id||i.user_id,slug:x?.slug||"",name:x?.full_name||"Unknown Artist"},artwork_count:0,view_count:0,like_count:0}})||[];C(M)}catch(a){console.error("Error loading catalogues:",a),f(a.message||"Failed to load catalogues"),n.error("Failed to load catalogues")}finally{N(!1)}},$=()=>{let a=[...v];if(o.trim()){const s=o.toLowerCase();a=a.filter(t=>t.title.toLowerCase().includes(s)||t.description?.toLowerCase().includes(s)||t.artist.name.toLowerCase().includes(s))}if(r.accessType!=="all"&&(a=a.filter(s=>s.access_type===r.accessType)),r.dateRange!=="all"){const s=new Date,t=new Date;switch(r.dateRange){case"today":t.setHours(0,0,0,0);break;case"week":t.setDate(s.getDate()-7);break;case"month":t.setMonth(s.getMonth()-1);break;case"year":t.setFullYear(s.getFullYear()-1);break}a=a.filter(p=>new Date(p.updated_at)>=t)}a.sort((s,t)=>{switch(h){case"newest":return new Date(t.updated_at).getTime()-new Date(s.updated_at).getTime();case"oldest":return new Date(s.updated_at).getTime()-new Date(t.updated_at).getTime();case"most_viewed":return t.view_count-s.view_count;case"most_liked":return t.like_count-s.like_count;case"alphabetical":return s.title.localeCompare(t.title);default:return 0}}),T(a)},A=async a=>{try{n.success("Added to favorites")}catch{n.error("Failed to update favorites")}},L=async a=>{try{const s=`${window.location.origin}/catalogue/${a.artist.slug}/${a.slug}`;navigator.share?await navigator.share({title:a.title,text:a.description||"",url:s}):(await navigator.clipboard.writeText(s),n.success("Link copied to clipboard!"))}catch{n.error("Failed to share catalogue")}};return D?e.jsxs("div",{className:"catalogues-loading",children:[e.jsx("div",{className:"catalogues-loading-spinner"}),e.jsx("p",{children:"Loading catalogues..."})]}):w?e.jsxs("div",{className:"catalogues-error",children:[e.jsx("h2",{children:"Error Loading Catalogues"}),e.jsx("p",{children:w}),e.jsx("button",{onClick:b,className:"brush-button primary",children:"Try Again"})]}):e.jsxs("div",{className:"catalogues-page",children:[e.jsxs(P,{children:[e.jsx("title",{children:"Browse Catalogues | ArtFlow"}),e.jsx("meta",{name:"description",content:"Discover digital art catalogues from talented artists around the world."})]}),e.jsx("div",{className:"catalogues-header",children:e.jsxs("div",{className:"catalogues-header-content",children:[e.jsxs("div",{className:"catalogues-header-text",children:[e.jsx("h1",{className:"catalogues-title",children:"Browse Catalogues"}),e.jsx("p",{className:"catalogues-subtitle",children:"Discover digital art catalogues from talented artists around the world"})]}),e.jsx("div",{className:"catalogues-stats",children:e.jsxs("div",{className:"catalogues-stat",children:[e.jsx("span",{className:"catalogues-stat-number",children:d.length}),e.jsx("span",{className:"catalogues-stat-label",children:"Catalogues"})]})})]})}),e.jsxs("div",{className:"catalogues-controls",children:[e.jsx("div",{className:"catalogues-search",children:e.jsxs("div",{className:"catalogues-search-input",children:[e.jsx(c,{name:"search",size:20,className:"catalogues-search-icon"}),e.jsx("input",{type:"text",placeholder:"Search catalogues, artists, or descriptions...",value:o,onChange:a=>y(a.target.value),className:"catalogues-search-field"})]})}),e.jsxs("div",{className:"catalogues-controls-right",children:[e.jsxs("button",{onClick:()=>S(!g),className:`catalogues-filter-button ${g?"active":""}`,children:[e.jsx(c,{name:"sliders-horizontal",size:16}),"Filters"]}),e.jsxs("div",{className:"catalogues-view-toggle",children:[e.jsx("button",{onClick:()=>_("grid"),className:`catalogues-view-button ${u==="grid"?"active":""}`,children:e.jsx(c,{name:"grid-3x3",size:16})}),e.jsx("button",{onClick:()=>_("list"),className:`catalogues-view-button ${u==="list"?"active":""}`,children:e.jsx(c,{name:"list",size:16})})]}),e.jsx("div",{className:"catalogues-sort",children:e.jsxs("select",{value:h,onChange:a=>F(a.target.value),className:"catalogues-sort-select",children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"most_viewed",children:"Most Viewed"}),e.jsx("option",{value:"most_liked",children:"Most Liked"}),e.jsx("option",{value:"alphabetical",children:"A-Z"})]})})]})]}),g&&e.jsx("div",{className:"catalogues-filters-panel",children:e.jsxs("div",{className:"catalogues-filters-content",children:[e.jsxs("div",{className:"catalogues-filter-group",children:[e.jsx("label",{className:"catalogues-filter-label",children:"Access Type"}),e.jsxs("select",{value:r.accessType,onChange:a=>m(s=>({...s,accessType:a.target.value})),className:"catalogues-filter-select",children:[e.jsx("option",{value:"all",children:"All Access Types"}),e.jsx("option",{value:"public",children:"Public Only"}),e.jsx("option",{value:"password_protected",children:"Password Protected"}),e.jsx("option",{value:"private",children:"Private Only"})]})]}),e.jsxs("div",{className:"catalogues-filter-group",children:[e.jsx("label",{className:"catalogues-filter-label",children:"Date Range"}),e.jsxs("select",{value:r.dateRange,onChange:a=>m(s=>({...s,dateRange:a.target.value})),className:"catalogues-filter-select",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"}),e.jsx("option",{value:"year",children:"This Year"})]})]})]})}),e.jsx("div",{className:"catalogues-results",children:d.length>0?e.jsx("div",{className:`catalogues-grid ${u==="list"?"list-view":""}`,children:d.map(a=>e.jsxs("div",{className:"catalogue-card",children:[e.jsx(j,{to:`/catalogue/${a.artist.slug}/${a.slug}`,className:"catalogue-card-link",children:e.jsxs("div",{className:"catalogue-card-image",children:[a.cover_image_url?e.jsx("img",{src:a.cover_image_url,alt:a.title,className:"catalogue-card-img"}):e.jsx("div",{className:"catalogue-card-placeholder",children:e.jsx(c,{name:"book-open",size:48})}),e.jsx("div",{className:"catalogue-card-overlay",children:e.jsxs("div",{className:"catalogue-card-actions",children:[e.jsx("button",{onClick:s=>{s.preventDefault(),A(a.id)},className:"catalogue-card-action",children:e.jsx(c,{name:"heart",size:16})}),e.jsx("button",{onClick:s=>{s.preventDefault(),L(a)},className:"catalogue-card-action",children:e.jsx(c,{name:"share-2",size:16})})]})})]})}),e.jsxs("div",{className:"catalogue-card-content",children:[e.jsx("div",{className:"catalogue-card-header",children:e.jsxs(j,{to:`/artist/${a.artist.slug}`,className:"catalogue-card-artist",children:[e.jsx("img",{src:a.artist.avatar_url||"/api/placeholder/32/32",alt:a.artist.name,className:"catalogue-card-avatar"}),e.jsx("span",{className:"catalogue-card-artist-name",children:a.artist.name})]})}),e.jsx(j,{to:`/catalogue/${a.artist.slug}/${a.slug}`,className:"catalogue-card-title-link",children:e.jsx("h3",{className:"catalogue-card-title",children:a.title})}),a.description&&e.jsx("p",{className:"catalogue-card-description",children:a.description.length>100?`${a.description.substring(0,100)}...`:a.description}),e.jsxs("div",{className:"catalogue-card-meta",children:[e.jsxs("div",{className:"catalogue-card-stats",children:[e.jsxs("div",{className:"catalogue-card-stat",children:[e.jsx(c,{name:"eye",size:14}),e.jsxs("span",{children:[a.artwork_count," artworks"]})]}),e.jsxs("div",{className:"catalogue-card-stat",children:[e.jsx(c,{name:"calendar",size:14}),e.jsx("span",{children:new Date(a.updated_at).toLocaleDateString()})]})]}),e.jsx("div",{className:"catalogue-card-access",children:e.jsx("span",{className:`catalogue-access-badge ${a.access_type}`,children:a.access_type==="public"?"Public":a.access_type==="password_protected"?"Password Protected":"Private"})})]})]})]},a.id))}):e.jsxs("div",{className:"catalogues-empty",children:[e.jsx(c,{name:"book-open",size:64,className:"catalogues-empty-icon"}),e.jsx("h3",{className:"catalogues-empty-title",children:"No catalogues found"}),e.jsx("p",{className:"catalogues-empty-description",children:o||Object.values(r).some(a=>a!=="all")?"Try adjusting your search or filters to find more catalogues.":"No public catalogues are available yet. Check back later!"}),(o||Object.values(r).some(a=>a!=="all"))&&e.jsx("button",{onClick:()=>{y(""),m({accessType:"all",dateRange:"all"})},className:"brush-button primary",children:"Clear Filters"})]})})]})};export{B as default};
