import{d as N,r as o,s as I,j as r,H as D}from"./index-Tyz_JBt9.js";import{C as A}from"./Container-D0TcWsx1.js";import{s as c,a as m}from"./errorHandling-CFCT0cl6.js";import{c as E}from"./createLucideIcon-DhCu6Z8O.js";import{S as R}from"./search-DqHloScL.js";import{B as v}from"./bell-DU0zGtQB.js";import{T as L}from"./trash-2-D5A2OpTS.js";import{C as F}from"./calendar-DCCf2P0w.js";import{E as B}from"./eye-Ctq-Wxgo.js";import{M as U}from"./message-square-gjEAjqvW.js";import{S as O}from"./shopping-bag-CVLz1XsG.js";import{H as W}from"./heart-BZ8u-Y3T.js";import"./logger-CnymG8OQ.js";/**
 * @license lucide-react v0.543.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],x=E("check",H),ae=()=>{const{user:p}=N(),[u,n]=o.useState([]),[y,f]=o.useState(!0),[i,h]=o.useState(""),[l,b]=o.useState("all"),[d,w]=o.useState([]);o.useEffect(()=>{p&&j()},[p]),o.useEffect(()=>{k()},[u,i,l]);const j=async()=>{try{f(!0);const{data:e,error:a}=await I.from("user_notifications").select("*").eq("user_id",p?.id).order("created_at",{ascending:!1});if(a){if(a.code==="PGRST116"||a.message.includes('relation "user_notifications" does not exist')){const t=[{id:"1",type:"artwork_liked",title:"Someone liked your artwork",message:'Sarah Johnson liked your artwork "Sunset Dreams"',data:{artworkId:"art1",likerName:"Sarah Johnson"},read:!1,createdAt:new Date(Date.now()-18e5).toISOString(),actionUrl:"/artwork/sunset-dreams"},{id:"2",type:"price_drop",title:"Price drop alert",message:'The artwork "Ocean Waves" you saved is now 20% off',data:{artworkId:"art2",oldPrice:5e3,newPrice:4e3},read:!1,createdAt:new Date(Date.now()-72e5).toISOString(),actionUrl:"/artwork/ocean-waves"},{id:"3",type:"new_message",title:"New message from collector",message:'You have a new message about "Mountain View"',data:{conversationId:"conv1",senderName:"Mike Chen"},read:!0,createdAt:new Date(Date.now()-864e5).toISOString(),actionUrl:"/messages/conv1"},{id:"4",type:"sale_completed",title:"Sale completed",message:'Your artwork "City Lights" has been sold for R8,500',data:{artworkId:"art3",price:8500},read:!0,createdAt:new Date(Date.now()-1728e5).toISOString(),actionUrl:"/u/sales"}];n(t);return}throw a}const s=(e||[]).map(t=>({id:t.id,type:t.type,title:t.title,message:t.message,data:t.data,read:t.read,createdAt:t.created_at,actionUrl:t.action_url}));n(s)}catch(e){console.error("Error loading notifications:",e),c("Failed to load notifications")}finally{f(!1)}},k=()=>{let e=u;if(l==="unread"?e=e.filter(a=>!a.read):l==="read"&&(e=e.filter(a=>a.read)),i.trim()){const a=i.toLowerCase();e=e.filter(s=>s.title.toLowerCase().includes(a)||s.message.toLowerCase().includes(a))}w(e)},S=async e=>{try{n(a=>a.map(s=>s.id===e?{...s,read:!0}:s)),m("Marked as read")}catch(a){console.error("Error marking notification as read:",a),c("Failed to mark as read")}},C=async()=>{try{n(e=>e.map(a=>({...a,read:!0}))),m("All notifications marked as read")}catch(e){console.error("Error marking all as read:",e),c("Failed to mark all as read")}},T=async e=>{try{n(a=>a.filter(s=>s.id!==e)),m("Notification deleted")}catch(a){console.error("Error deleting notification:",a),c("Failed to delete notification")}},z=e=>{switch(e){case"artwork_liked":return r.jsx(W,{size:20});case"artwork_purchased":return r.jsx(O,{size:20});case"new_message":return r.jsx(U,{size:20});case"price_drop":return r.jsx(v,{size:20});case"new_artwork":return r.jsx(B,{size:20});case"sale_completed":return r.jsx(x,{size:20});case"shipping_update":return r.jsx(F,{size:20});default:return r.jsx(v,{size:20})}},_=e=>{switch(e){case"artwork_liked":return"var(--success)";case"artwork_purchased":return"var(--primary)";case"new_message":return"var(--info)";case"price_drop":return"var(--warning)";case"new_artwork":return"var(--info)";case"sale_completed":return"var(--success)";case"shipping_update":return"var(--info)";default:return"var(--muted)"}},M=e=>{const a=new Date(e),t=Math.floor((new Date().getTime()-a.getTime())/(1e3*60));return t<1?"Just now":t<60?`${t}m ago`:t<1440?`${Math.floor(t/60)}h ago`:`${Math.floor(t/1440)}d ago`},g=u.filter(e=>!e.read).length;return y?r.jsx("div",{style:{padding:"var(--space-xl)",textAlign:"center"},children:r.jsx("div",{style:{fontSize:"18px",color:"var(--muted)"},children:"Loading notifications..."})}):r.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"var(--bg)"},children:[r.jsxs(D,{children:[r.jsx("title",{children:"Notifications | ArtFlow"}),r.jsx("meta",{name:"description",content:"Your notifications on ArtFlow"})]}),r.jsx(A,{children:r.jsxs("div",{style:{padding:"var(--space-xl) 0"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--space-xl)",flexWrap:"wrap",gap:"var(--space-md)"},children:[r.jsxs("div",{children:[r.jsxs("h1",{style:{fontSize:"32px",fontWeight:"600",margin:"0 0 var(--space-sm) 0",color:"var(--fg)"},children:["Notifications",g>0&&r.jsx("span",{style:{backgroundColor:"var(--primary)",color:"white",fontSize:"14px",padding:"2px 8px",borderRadius:"12px",marginLeft:"var(--space-sm)"},children:g})]}),r.jsxs("p",{style:{color:"var(--muted)",margin:0,fontSize:"16px"},children:[d.length," ",d.length===1?"notification":"notifications"]})]}),g>0&&r.jsxs("button",{onClick:C,style:{display:"flex",alignItems:"center",gap:"var(--space-xs)",padding:"var(--space-sm) var(--space-md)",backgroundColor:"var(--bg-alt)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",color:"var(--fg)",cursor:"pointer",fontSize:"14px",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--primary)",e.currentTarget.style.color="white",e.currentTarget.style.borderColor="var(--primary)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="var(--bg-alt)",e.currentTarget.style.color="var(--fg)",e.currentTarget.style.borderColor="var(--border)"},children:[r.jsx(x,{size:16}),"Mark all read"]})]}),r.jsxs("div",{style:{display:"flex",gap:"var(--space-md)",marginBottom:"var(--space-xl)",flexWrap:"wrap",alignItems:"center"},children:[r.jsxs("div",{style:{position:"relative",flex:"1",minWidth:"300px"},children:[r.jsx(R,{size:20,style:{position:"absolute",left:"var(--space-md)",top:"50%",transform:"translateY(-50%)",color:"var(--muted)"}}),r.jsx("input",{type:"text",placeholder:"Search notifications...",value:i,onChange:e=>h(e.target.value),style:{width:"100%",padding:"var(--space-md) var(--space-md) var(--space-md) 48px",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--bg)",color:"var(--fg)",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease"},onFocus:e=>{e.target.style.borderColor="var(--primary)"},onBlur:e=>{e.target.style.borderColor="var(--border)"}})]}),r.jsxs("select",{value:l,onChange:e=>b(e.target.value),style:{padding:"var(--space-md)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--bg)",color:"var(--fg)",fontSize:"16px",outline:"none",cursor:"pointer"},children:[r.jsx("option",{value:"all",children:"All Notifications"}),r.jsx("option",{value:"unread",children:"Unread Only"}),r.jsx("option",{value:"read",children:"Read Only"})]})]}),d.length===0?r.jsxs("div",{style:{textAlign:"center",padding:"var(--space-xxl)",color:"var(--muted)"},children:[r.jsx(v,{size:48,style:{marginBottom:"var(--space-md)",opacity:.5}}),r.jsx("h3",{style:{margin:"0 0 var(--space-sm) 0",fontSize:"20px"},children:i?"No notifications match your search":"No notifications yet"}),r.jsx("p",{style:{margin:0},children:i?"Try adjusting your search terms":"You'll see notifications about your activity here"})]}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-md)"},children:d.map(e=>r.jsxs("div",{style:{backgroundColor:e.read?"var(--bg-alt)":"var(--bg)",border:"1px solid var(--border)",borderRadius:"var(--radius-lg)",padding:"var(--space-lg)",transition:"all 0.2s ease",position:"relative"},children:[!e.read&&r.jsx("div",{style:{position:"absolute",top:"var(--space-md)",right:"var(--space-md)",width:"8px",height:"8px",backgroundColor:"var(--primary)",borderRadius:"50%"}}),r.jsxs("div",{style:{display:"flex",gap:"var(--space-md)",alignItems:"flex-start"},children:[r.jsx("div",{style:{color:_(e.type),marginTop:"2px"},children:z(e.type)}),r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"var(--space-xs)"},children:[r.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",margin:0,color:"var(--fg)"},children:e.title}),r.jsx("span",{style:{fontSize:"12px",color:"var(--muted)",marginLeft:"var(--space-sm)"},children:M(e.createdAt)})]}),r.jsx("p",{style:{color:"var(--muted)",margin:"0 0 var(--space-md) 0",fontSize:"14px",lineHeight:"1.5"},children:e.message}),r.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)",alignItems:"center"},children:[e.actionUrl&&r.jsx("a",{href:e.actionUrl,style:{fontSize:"14px",color:"var(--primary)",textDecoration:"none",fontWeight:"500"},onMouseEnter:a=>{a.currentTarget.style.textDecoration="underline"},onMouseLeave:a=>{a.currentTarget.style.textDecoration="none"},children:"View Details"}),!e.read&&r.jsxs("button",{onClick:()=>S(e.id),style:{display:"flex",alignItems:"center",gap:"var(--space-xs)",padding:"var(--space-xs) var(--space-sm)",backgroundColor:"transparent",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)",color:"var(--muted)",cursor:"pointer",fontSize:"12px",transition:"all 0.2s ease"},onMouseEnter:a=>{a.currentTarget.style.backgroundColor="var(--bg-alt)",a.currentTarget.style.color="var(--fg)"},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="transparent",a.currentTarget.style.color="var(--muted)"},children:[r.jsx(x,{size:12}),"Mark read"]}),r.jsxs("button",{onClick:()=>T(e.id),style:{display:"flex",alignItems:"center",gap:"var(--space-xs)",padding:"var(--space-xs) var(--space-sm)",backgroundColor:"transparent",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)",color:"var(--muted)",cursor:"pointer",fontSize:"12px",transition:"all 0.2s ease"},onMouseEnter:a=>{a.currentTarget.style.backgroundColor="var(--error)",a.currentTarget.style.color="white",a.currentTarget.style.borderColor="var(--error)"},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="transparent",a.currentTarget.style.color="var(--muted)",a.currentTarget.style.borderColor="var(--border)"},children:[r.jsx(L,{size:12}),"Delete"]})]})]})]})]},e.id))})]})})]})};export{ae as default};
