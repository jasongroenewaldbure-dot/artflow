import{d as _,r as s,s as A,j as r,H as F,a as I}from"./index-Tyz_JBt9.js";import{C as L}from"./Container-D0TcWsx1.js";import{s as l}from"./errorHandling-CFCT0cl6.js";import{S as R}from"./share-2-BUMbV-vM.js";import{S as T}from"./search-DqHloScL.js";import{G as E,L as D}from"./list-BOiaReEr.js";import{S as W}from"./shopping-bag-CVLz1XsG.js";import{E as B}from"./eye-Ctq-Wxgo.js";import{F as M}from"./file-text-DVS8IP3-.js";import{D as O}from"./download-DogKkANh.js";import"./logger-CnymG8OQ.js";import"./createLucideIcon-DhCu6Z8O.js";const X=()=>{const{user:p}=_(),[u,g]=s.useState([]),[x,v]=s.useState(!0),[n,m]=s.useState("grid"),[t,h]=s.useState(""),[d,y]=s.useState([]),[c,f]=s.useState("all");s.useEffect(()=>{p&&b()},[p]),s.useEffect(()=>{w()},[u,t,c]);const b=async()=>{try{v(!0);const{data:e,error:o}=await A.from("user_collection").select(`
          status, created_at,
          artworks!inner(
            id, title, price, currency, medium, year, dimensions, primary_image_url, 
            genre, created_at,
            profiles!artworks_user_id_fkey(full_name, slug)
          )
        `).eq("user_id",p?.id).order("created_at",{ascending:!1});if(o){if(o.code==="PGRST116"||o.message.includes('relation "user_collection" does not exist')){g([]);return}throw o}const i=(e||[]).map(a=>({id:a.artworks?.[0]?.id||a.artworks?.id,title:a.artworks?.[0]?.title||a.artworks?.title||"Untitled",artist:{name:a.artworks?.[0]?.profiles?.[0]?.full_name||a.artworks?.profiles?.[0]?.full_name||"Unknown Artist",slug:a.artworks?.[0]?.profiles?.[0]?.slug||a.artworks?.profiles?.[0]?.slug||a.artworks?.[0]?.id||a.artworks?.id},primaryImageUrl:a.artworks?.[0]?.primary_image_url||a.artworks?.primary_image_url||"",price:a.artworks?.[0]?.price||a.artworks?.price||0,currency:a.artworks?.[0]?.currency||a.artworks?.currency||"ZAR",medium:a.artworks?.[0]?.medium||a.artworks?.medium||"",year:a.artworks?.[0]?.year||a.artworks?.year||new Date().getFullYear(),dimensions:a.artworks?.[0]?.dimensions||a.artworks?.dimensions,genre:a.artworks?.[0]?.genre||a.artworks?.genre||"",purchasedAt:a.created_at,status:a.status}));g(i)}catch(e){console.error("Error loading collection:",e),l("Failed to load collection")}finally{v(!1)}},w=()=>{let e=u;if(c!=="all"&&(e=e.filter(o=>o.status===c)),t.trim()){const o=t.toLowerCase();e=e.filter(i=>i.title.toLowerCase().includes(o)||i.artist.name.toLowerCase().includes(o)||i.medium.toLowerCase().includes(o)||i.genre.toLowerCase().includes(o))}y(e)},j=async e=>{try{l("Invoice download coming soon")}catch(o){console.error("Error downloading invoice:",o),l("Failed to download invoice")}},C=async e=>{try{l("COA download coming soon")}catch(o){console.error("Error downloading COA:",o),l("Failed to download COA")}},k=()=>{navigator.share?navigator.share({title:"My ArtFlow Collection",text:"Check out my art collection on ArtFlow",url:window.location.href}):(navigator.clipboard.writeText(window.location.href),l("Link copied to clipboard"))},S=e=>{switch(e){case"purchased":return"var(--warning)";case"shipped":return"var(--info)";case"delivered":return"var(--success)";default:return"var(--muted)"}},z=e=>{switch(e){case"purchased":return"Purchased";case"shipped":return"Shipped";case"delivered":return"Delivered";default:return e}};return x?r.jsx("div",{style:{padding:"var(--space-xl)",textAlign:"center"},children:r.jsx("div",{style:{fontSize:"18px",color:"var(--muted)"},children:"Loading your collection..."})}):r.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"var(--bg)"},children:[r.jsxs(F,{children:[r.jsx("title",{children:"My Collection | ArtFlow"}),r.jsx("meta",{name:"description",content:"Your art collection on ArtFlow"})]}),r.jsx(L,{children:r.jsxs("div",{style:{padding:"var(--space-xl) 0"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--space-xl)",flexWrap:"wrap",gap:"var(--space-md)"},children:[r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:"32px",fontWeight:"600",margin:"0 0 var(--space-sm) 0",color:"var(--fg)"},children:"My Collection"}),r.jsxs("p",{style:{color:"var(--muted)",margin:0,fontSize:"16px"},children:[d.length," ",d.length===1?"artwork":"artworks"," in your collection"]})]}),r.jsx("div",{style:{display:"flex",gap:"var(--space-sm)",alignItems:"center"},children:r.jsxs("button",{onClick:k,style:{display:"flex",alignItems:"center",gap:"var(--space-xs)",padding:"var(--space-sm) var(--space-md)",backgroundColor:"var(--bg-alt)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",color:"var(--fg)",cursor:"pointer",fontSize:"14px",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--primary)",e.currentTarget.style.color="white",e.currentTarget.style.borderColor="var(--primary)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="var(--bg-alt)",e.currentTarget.style.color="var(--fg)",e.currentTarget.style.borderColor="var(--border)"},children:[r.jsx(R,{size:16}),"Share"]})})]}),r.jsxs("div",{style:{display:"flex",gap:"var(--space-md)",marginBottom:"var(--space-xl)",flexWrap:"wrap",alignItems:"center"},children:[r.jsxs("div",{style:{position:"relative",flex:"1",minWidth:"300px"},children:[r.jsx(T,{size:20,style:{position:"absolute",left:"var(--space-md)",top:"50%",transform:"translateY(-50%)",color:"var(--muted)"}}),r.jsx("input",{type:"text",placeholder:"Search your collection...",value:t,onChange:e=>h(e.target.value),style:{width:"100%",padding:"var(--space-md) var(--space-md) var(--space-md) 48px",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--bg)",color:"var(--fg)",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease"},onFocus:e=>{e.target.style.borderColor="var(--primary)"},onBlur:e=>{e.target.style.borderColor="var(--border)"}})]}),r.jsxs("select",{value:c,onChange:e=>f(e.target.value),style:{padding:"var(--space-md)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",backgroundColor:"var(--bg)",color:"var(--fg)",fontSize:"16px",outline:"none",cursor:"pointer"},children:[r.jsx("option",{value:"all",children:"All Status"}),r.jsx("option",{value:"purchased",children:"Purchased"}),r.jsx("option",{value:"shipped",children:"Shipped"}),r.jsx("option",{value:"delivered",children:"Delivered"})]}),r.jsxs("div",{style:{display:"flex",gap:"var(--space-xs)"},children:[r.jsx("button",{onClick:()=>m("grid"),style:{padding:"var(--space-sm)",backgroundColor:n==="grid"?"var(--primary)":"var(--bg-alt)",color:n==="grid"?"white":"var(--fg)",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)",cursor:"pointer",transition:"all 0.2s ease"},children:r.jsx(E,{size:16})}),r.jsx("button",{onClick:()=>m("list"),style:{padding:"var(--space-sm)",backgroundColor:n==="list"?"var(--primary)":"var(--bg-alt)",color:n==="list"?"white":"var(--fg)",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)",cursor:"pointer",transition:"all 0.2s ease"},children:r.jsx(D,{size:16})})]})]}),d.length===0?r.jsxs("div",{style:{textAlign:"center",padding:"var(--space-xxl)",color:"var(--muted)"},children:[r.jsx(W,{size:48,style:{marginBottom:"var(--space-md)",opacity:.5}}),r.jsx("h3",{style:{margin:"0 0 var(--space-sm) 0",fontSize:"20px"},children:t?"No artworks match your search":"No artworks in your collection yet"}),r.jsx("p",{style:{margin:"0 0 var(--space-lg) 0"},children:t?"Try adjusting your search terms":"Start exploring and purchase artworks you love"}),!t&&r.jsxs(I,{to:"/",style:{display:"inline-flex",alignItems:"center",gap:"var(--space-xs)",padding:"var(--space-md) var(--space-lg)",backgroundColor:"var(--primary)",color:"white",textDecoration:"none",borderRadius:"var(--radius-md)",fontSize:"16px",fontWeight:"500",transition:"all 0.2s ease"},children:[r.jsx(B,{size:16}),"Explore Artworks"]})]}):r.jsx("div",{style:{display:"grid",gridTemplateColumns:n==="grid"?"repeat(auto-fill, minmax(280px, 1fr))":"1fr",gap:"var(--space-lg)"},children:d.map(e=>r.jsx("div",{style:{position:"relative"},children:r.jsxs("div",{style:{backgroundColor:"var(--bg-alt)",borderRadius:"var(--radius-lg)",padding:"var(--space-lg)",border:"1px solid var(--border)",transition:"all 0.2s ease"},children:[r.jsxs("div",{style:{marginBottom:"var(--space-md)"},children:[r.jsx("img",{src:e.primaryImageUrl,alt:e.title,style:{width:"100%",height:"200px",objectFit:"cover",borderRadius:"var(--radius-md)",marginBottom:"var(--space-md)"}}),r.jsx("div",{style:{position:"absolute",top:"var(--space-md)",right:"var(--space-md)",backgroundColor:S(e.status),color:"white",padding:"var(--space-xs) var(--space-sm)",borderRadius:"var(--radius-sm)",fontSize:"12px",fontWeight:"500"},children:z(e.status)})]}),r.jsxs("div",{children:[r.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",margin:"0 0 var(--space-xs) 0",color:"var(--fg)"},children:e.title}),r.jsxs("p",{style:{color:"var(--muted)",margin:"0 0 var(--space-sm) 0",fontSize:"14px"},children:["by ",e.artist.name]}),r.jsxs("p",{style:{fontSize:"16px",fontWeight:"600",margin:"0 0 var(--space-md) 0",color:"var(--fg)"},children:[e.currency," ",e.price.toLocaleString()]}),r.jsxs("div",{style:{display:"flex",gap:"var(--space-sm)",marginTop:"var(--space-md)"},children:[r.jsxs("button",{onClick:()=>j(e.id),style:{display:"flex",alignItems:"center",gap:"var(--space-xs)",padding:"var(--space-sm) var(--space-md)",backgroundColor:"var(--bg)",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)",color:"var(--fg)",cursor:"pointer",fontSize:"14px",transition:"all 0.2s ease",flex:1},children:[r.jsx(M,{size:14}),"Invoice"]}),r.jsxs("button",{onClick:()=>C(e.id),style:{display:"flex",alignItems:"center",gap:"var(--space-xs)",padding:"var(--space-sm) var(--space-md)",backgroundColor:"var(--bg)",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)",color:"var(--fg)",cursor:"pointer",fontSize:"14px",transition:"all 0.2s ease",flex:1},children:[r.jsx(O,{size:14}),"COA"]})]})]})]})},e.id))})]})})]})};export{X as default};
