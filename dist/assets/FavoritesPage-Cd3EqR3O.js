import{d as F,r as o,s as b,j as e,H as C,a as x}from"./index-Tyz_JBt9.js";import{C as L}from"./Container-D0TcWsx1.js";import{s as N,a as S}from"./errorHandling-CFCT0cl6.js";import{I as a}from"./Icon-DdnnFTJv.js";import"./logger-CnymG8OQ.js";const M=()=>{const{user:n}=F(),[l,u]=o.useState([]),[f,h]=o.useState(!0),[d,g]=o.useState("grid"),[i,v]=o.useState(""),[c,p]=o.useState([]);o.useEffect(()=>{n&&_()},[n]),o.useEffect(()=>{k()},[l,i]);const _=async()=>{try{h(!0);const{data:s,error:t}=await b.from("user_favorites").select(`
          created_at,
          artworks!inner(
            id, title, primary_image_url, price, currency, medium, year, dimensions, genre,
            profiles!artworks_user_id_fkey(
              display_name, slug, avatar_url
            )
          )
        `).eq("user_id",n?.id).order("created_at",{ascending:!1});if(t)throw t;const m=(s||[]).map(r=>({id:r.artworks.id,title:r.artworks.title||"Untitled",artist:{name:r.artworks.profiles?.display_name||"Unknown Artist",slug:r.artworks.profiles?.slug||"",avatar_url:r.artworks.profiles?.avatar_url},primary_image_url:r.artworks.primary_image_url||"",price:r.artworks.price||0,currency:r.artworks.currency||"ZAR",medium:r.artworks.medium||"",year:r.artworks.year||new Date().getFullYear(),dimensions:r.artworks.dimensions,genre:r.artworks.genre||"",favorited_at:r.created_at}));u(m)}catch(s){console.error("Error loading favorites:",s),N("Failed to load favorites")}finally{h(!1)}},k=()=>{if(!i.trim()){p(l);return}const s=l.filter(t=>t.title.toLowerCase().includes(i.toLowerCase())||t.artist.name.toLowerCase().includes(i.toLowerCase())||t.medium.toLowerCase().includes(i.toLowerCase())||t.genre.toLowerCase().includes(i.toLowerCase()));p(s)},y=async s=>{if(n)try{const{error:t}=await b.from("user_favorites").delete().eq("user_id",n.id).eq("artwork_id",s);if(t)throw t;u(m=>m.filter(r=>r.id!==s)),S("Removed from favorites")}catch(t){console.error("Error removing favorite:",t),N("Failed to remove from favorites")}},j=(s,t)=>new Intl.NumberFormat("en-ZA",{style:"currency",currency:t}).format(s),w=s=>new Date(s).toLocaleDateString("en-ZA",{year:"numeric",month:"short",day:"numeric"});return e.jsxs(L,{children:[e.jsx(C,{children:e.jsx("title",{children:"My Favorites | ArtFlow"})}),e.jsxs("div",{className:"py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Favorites"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:[l.length," artwork",l.length!==1?"s":""," saved"]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(a,{name:"search",size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:i,onChange:s=>v(s.target.value),placeholder:"Search favorites...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>g("grid"),className:`p-2 rounded-md ${d==="grid"?"bg-white shadow-sm":""}`,children:e.jsx(a,{name:"grid",size:20})}),e.jsx("button",{onClick:()=>g("list"),className:`p-2 rounded-md ${d==="list"?"bg-white shadow-sm":""}`,children:e.jsx(a,{name:"list",size:20})})]})]})]}),f?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsx(e.Fragment,{children:c.length===0&&l.length>0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(a,{name:"search",size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No favorites found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your search terms"})]}):c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(a,{name:"heart",size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No favorites yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Start exploring and save artworks you love"}),e.jsxs(x,{to:"/explore",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(a,{name:"search",size:20,className:"mr-2"}),"Explore Artworks"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("p",{className:"text-gray-600",children:[c.length," of ",l.length," favorites"]})}),d==="grid"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:c.map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"aspect-square bg-gray-100 relative group",children:[e.jsx("img",{src:s.primary_image_url||"/placeholder-artwork.jpg",alt:s.title,className:"w-full h-full object-cover"}),e.jsx("button",{onClick:()=>y(s.id),className:"absolute top-3 right-3 p-2 bg-white/80 backdrop-blur-sm rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-white",children:e.jsx(a,{name:"heart-filled",size:20,color:"#ef4444"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:s.title}),e.jsx(x,{to:`/artist/${s.artist.slug}`,className:"text-sm text-gray-600 hover:text-blue-600 mt-1 block",children:s.artist.name}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[s.medium," • ",s.year]}),e.jsx("p",{className:"font-semibold text-gray-900 mt-2",children:j(s.price,s.currency)}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Added ",w(s.favorited_at)]})]})]},s.id))}):e.jsx("div",{className:"space-y-4",children:c.map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 flex items-center space-x-4",children:[e.jsx("img",{src:s.primary_image_url||"/placeholder-artwork.jpg",alt:s.title,className:"w-20 h-20 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.title}),e.jsx(x,{to:`/artist/${s.artist.slug}`,className:"text-sm text-gray-600 hover:text-blue-600",children:s.artist.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.medium," • ",s.year]}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Added ",w(s.favorited_at)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:j(s.price,s.currency)}),e.jsx("button",{onClick:()=>y(s.id),className:"mt-2 p-2 hover:bg-gray-100 rounded-full",children:e.jsx(a,{name:"heart-filled",size:20,color:"#ef4444"})})]})]},s.id))})]})})]})]})};export{M as default};
