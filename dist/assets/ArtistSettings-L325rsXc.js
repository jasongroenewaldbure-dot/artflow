import{r,s as i,j as e,H as w}from"./index-Tyz_JBt9.js";function A(){const[l,o]=r.useState(""),[d,c]=r.useState(""),[u,g]=r.useState(""),[n,h]=r.useState(""),[x,f]=r.useState(!1),p=r.useRef(null);r.useEffect(()=>{(async()=>{const{data:t}=await i.auth.getUser(),s=t.user?.id;if(!s)return;const{data:a}=await i.from("profiles").select("full_name,bio,avatar_url").eq("id",s).single();a&&(o(a.full_name||""),c(a.bio||""),g(""),h(a.avatar_url||""))})()},[]);async function j(t){const{data:s}=await i.auth.getUser(),a=s.user?.id;if(!a)return;const S=t.name.split(".").pop()||"jpg",v=`avatars/${a}/${Date.now()}.${S}`,m=await i.storage.from("avatars").upload(v,t,{upsert:!0});if(m.error){alert(m.error.message);return}const{data:y}=i.storage.from("avatars").getPublicUrl(v);h(y.publicUrl)}async function b(){f(!0);const{data:t}=await i.auth.getUser(),s=t.user?.id;if(!s)return;const{error:a}=await i.from("profiles").upsert({id:s,full_name:l,bio:d,statement:u,avatar_url:n});f(!1),alert(a?a.message:"Saved")}return e.jsxs("div",{style:{padding:24,maxWidth:800},children:[e.jsx(w,{children:e.jsx("title",{children:"Artist Settings | Artflow"})}),e.jsx("h1",{children:"Artist Settings"}),e.jsxs("div",{style:{display:"grid",gap:12},children:[e.jsxs("div",{children:[e.jsx("label",{children:"Name"}),e.jsx("input",{value:l,onChange:t=>o(t.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Headshot"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[n?e.jsx("img",{src:n,alt:"Headshot",style:{width:72,height:72,borderRadius:"50%",objectFit:"cover"}}):e.jsx("div",{style:{width:72,height:72,borderRadius:"50%",background:"#222"}}),e.jsx("input",{ref:p,type:"file",accept:"image/*",onChange:t=>t.target.files&&j(t.target.files[0])})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Artist Statement"}),e.jsx("textarea",{value:u,onChange:t=>g(t.target.value),className:"textarea",rows:6})]}),e.jsxs("div",{children:[e.jsx("label",{children:"Bio"}),e.jsx("textarea",{value:d,onChange:t=>c(t.target.value),className:"textarea",rows:6})]}),e.jsx("div",{children:e.jsx("button",{className:"button button-primary",onClick:b,disabled:x,children:x?"Savingâ€¦":"Save"})})]})]})}export{A as default};
